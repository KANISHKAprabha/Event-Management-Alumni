{% extends 'base.html' %}
{% block title %}Event Overview - Alumni Event Management{% endblock %}
{% if request.user.is_admin}

{% block content %}
<div class="section container mt-4">
  <h2 class="mb-4">📋 Events Overview</h2>
{% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}" role="alert">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
  <div class="row g-4">
    {% for event in events %}
    <div class="col-12 col-sm-6 col-lg-4"> <!-- Responsive columns -->
      <div class="card shadow-sm p-3 d-flex flex-column h-100">
        <!-- Card Body -->
        <div class="d-flex flex-column h-100">
          <!-- Event Info -->
          <h3 class="mb-2">
            <a href="{% url 'event_detail' event.pk %}">{{ event.name }}</a>
          </h3>
          <p class="mb-1"><strong>Date:</strong> {{ event.date|date:"F j, Y g:i A" }}</p>
          <p class="mb-1"><strong>Type:</strong> {{ event.get_event_type_display }}</p>
          <p class="mb-2">
          
            <strong>Location:</strong> 
            {% if event.location_type == 'offline' %}
              📍 {{ event.physical_address|default:"TBD" }}
            {% else %}
            {% if request.user.is_authenticated %}
              🌐 <a href="{{ event.online_link }}" target="_blank">Join Online</a>
            {% else %}
              🌐 <p>Event Registeration is required to Access the link </p>
              {% endif %}
              
            {% endif %}
          </p>

          <!-- Registration Status -->
          <div class="p-2 rounded mb-3" style="background: rgba(102, 126, 234, 0.08);">
            {% if event.registration_deadline > now %}
              <p class="text-success fw-bold mb-1">✅ Registration Open</p>
              <a href="{% url 'register_event' event.id %}" class="btn btn-primary btn-sm">Register Now</a>
            {% else %}
              <p class="text-danger fw-bold mb-1">❌ Registration Closed</p>
            {% endif %}
          </div>

          {% if user.is_superuser %}
          <a href="{% url 'event_detail' event.pk %}" class="card-link mb-2">View Full Details →</a>
          {% endif %}

          <!-- Bottom Button -->
          <div class="mt-auto">
            <a href="{% url 'event_detail' event.pk %}" class="btn btn-sm btn-primary w-100">
              View agenda and forms →
            </a>
          </div>
        </div>
      </div>
    </div>
    {% empty %}
    <div class="col-12">
      <div class="card h-100 shadow-sm p-3 text-center">
        <h3>No Events Available</h3>
        <p class="text-muted fst-italic">
          No events have been created yet. Check back soon!
        </p>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

{% endblock %}
